import{J as x,r as m,l,E as o}from"./index-bbfbf08c.js";const T=[{taskNo:"JX202403180001",area:"化学品储存区A",inspector:"张明",startTime:"2024-03-18 08:00:00",endTime:"2024-03-18 17:00:00",status:"已完成",progress:100,content:"日常安全巡检",remark:"无异常"},{taskNo:"JX202403180002",area:"生产车间B",inspector:"李伟",startTime:"2024-03-18 09:00:00",endTime:"2024-03-18 18:00:00",status:"进行中",progress:60,content:"设备运行状态检查",remark:"2号生产线需要维护"},{taskNo:"JX202403180003",area:"仓储区C",inspector:"王强",startTime:"2024-03-18 10:00:00",endTime:"2024-03-18 19:00:00",status:"待执行",progress:0,content:"库存安全检查",remark:""},{taskNo:"JX202403170001",area:"化学品储存区A",inspector:"刘洋",startTime:"2024-03-17 08:00:00",endTime:"2024-03-17 17:00:00",status:"已完成",progress:100,content:"危险品存储检查",remark:"已完成整改"},{taskNo:"JX202403170002",area:"生产车间B",inspector:"陈勇",startTime:"2024-03-17 09:00:00",endTime:"2024-03-17 18:00:00",status:"已超时",progress:80,content:"设备维护检查",remark:"需要更换零件"},{taskNo:"JX202403160001",area:"仓储区C",inspector:"赵静",startTime:"2024-03-16 08:00:00",endTime:"2024-03-16 17:00:00",status:"已完成",progress:100,content:"货物堆放检查",remark:"已整理完成"},{taskNo:"JX202403160002",area:"化学品储存区A",inspector:"孙磊",startTime:"2024-03-16 09:00:00",endTime:"2024-03-16 18:00:00",status:"已完成",progress:100,content:"危险品泄漏检查",remark:"防泄漏设施完好"},{taskNo:"JX202403150001",area:"生产车间B",inspector:"周涛",startTime:"2024-03-15 08:00:00",endTime:"2024-03-15 17:00:00",status:"已完成",progress:100,content:"设备维护检查",remark:"已更换滤芯"},{taskNo:"JX202403150002",area:"仓储区C",inspector:"吴婷",startTime:"2024-03-15 09:00:00",endTime:"2024-03-15 18:00:00",status:"已完成",progress:100,content:"货物堆放检查",remark:"已整理货架"},{taskNo:"JX202403140001",area:"化学品储存区A",inspector:"郑阳",startTime:"2024-03-14 08:00:00",endTime:"2024-03-14 17:00:00",status:"已完成",progress:100,content:"通风系统检查",remark:"通风正常"},{taskNo:"JX202403140002",area:"生产车间B",inspector:"杨帆",startTime:"2024-03-14 09:00:00",endTime:"2024-03-14 18:00:00",status:"已完成",progress:100,content:"设备维护检查",remark:"已更换滤芯"},{taskNo:"JX202403130001",area:"仓储区C",inspector:"黄晓明",startTime:"2024-03-13 08:00:00",endTime:"2024-03-13 17:00:00",status:"已完成",progress:100,content:"货物堆放检查",remark:"已整理货架"},{taskNo:"JX202403130002",area:"化学品储存区A",inspector:"马超",startTime:"2024-03-13 09:00:00",endTime:"2024-03-13 18:00:00",status:"已完成",progress:100,content:"通风系统检查",remark:"通风正常"},{taskNo:"JX202403120001",area:"生产车间B",inspector:"徐亮",startTime:"2024-03-12 08:00:00",endTime:"2024-03-12 17:00:00",status:"已完成",progress:100,content:"安全生产检查",remark:"已补充防护用品"},{taskNo:"JX202403120002",area:"仓储区C",inspector:"朱峰",startTime:"2024-03-12 09:00:00",endTime:"2024-03-12 18:00:00",status:"已完成",progress:100,content:"仓库环境检查",remark:"温湿度正常"},{taskNo:"JX202403110001",area:"化学品储存区A",inspector:"韩雪",startTime:"2024-03-11 08:00:00",endTime:"2024-03-11 17:00:00",status:"已完成",progress:100,content:"化学品标签检查",remark:"标签完整清晰"},{taskNo:"JX202403110002",area:"生产车间B",inspector:"方明",startTime:"2024-03-11 09:00:00",endTime:"2024-03-11 18:00:00",status:"已完成",progress:100,content:"机械设备检查",remark:"传动装置正常"},{taskNo:"JX202403100001",area:"仓储区C",inspector:"董莉",startTime:"2024-03-10 08:00:00",endTime:"2024-03-10 17:00:00",status:"已完成",progress:100,content:"应急通道检查",remark:"通道畅通"},{taskNo:"JX202403100002",area:"化学品储存区A",inspector:"谢峰",startTime:"2024-03-10 09:00:00",endTime:"2024-03-10 18:00:00",status:"已完成",progress:100,content:"防护设施检查",remark:"防护设施完好"},{taskNo:"JX202403090001",area:"生产车间B",inspector:"罗静",startTime:"2024-03-09 08:00:00",endTime:"2024-03-09 17:00:00",status:"已完成",progress:100,content:"噪音检测",remark:"噪音达标"},{taskNo:"JX202403090002",area:"仓储区C",inspector:"唐军",startTime:"2024-03-09 09:00:00",endTime:"2024-03-09 18:00:00",status:"已完成",progress:100,content:"货物包装检查",remark:"包装完整"},{taskNo:"JX202403080001",area:"化学品储存区A",inspector:"邓超",startTime:"2024-03-08 08:00:00",endTime:"2024-03-08 17:00:00",status:"已完成",progress:100,content:"泄漏应急演练",remark:"演练完成"},{taskNo:"JX202403080002",area:"生产车间B",inspector:"范丽",startTime:"2024-03-08 09:00:00",endTime:"2024-03-08 18:00:00",status:"已完成",progress:100,content:"工具检查",remark:"工具完备"},{taskNo:"JX202403070001",area:"仓储区C",inspector:"蒋勇",startTime:"2024-03-07 08:00:00",endTime:"2024-03-07 17:00:00",status:"已完成",progress:100,content:"照明系统检查",remark:"照明正常"},{taskNo:"JX202403070002",area:"化学品储存区A",inspector:"魏明",startTime:"2024-03-07 09:00:00",endTime:"2024-03-07 18:00:00",status:"已完成",progress:100,content:"安全警示检查",remark:"警示标识完整"},{taskNo:"JX202403190001",area:"生产车间B",inspector:"韩雪",startTime:"2024-03-19 08:00:00",endTime:"2024-03-19 17:00:00",status:"待执行",progress:0,content:"设备润滑检查",remark:""},{taskNo:"JX202403190002",area:"仓储区C",inspector:"方明",startTime:"2024-03-19 09:00:00",endTime:"2024-03-19 18:00:00",status:"待执行",progress:0,content:"消防通道检查",remark:""},{taskNo:"JX202403190003",area:"化学品储存区A",inspector:"董莉",startTime:"2024-03-19 10:00:00",endTime:"2024-03-19 19:00:00",status:"待执行",progress:0,content:"应急设备检查",remark:""},{taskNo:"JX202403190004",area:"生产车间B",inspector:"谢峰",startTime:"2024-03-19 11:00:00",endTime:"2024-03-19 20:00:00",status:"待执行",progress:0,content:"安全培训检查",remark:""}],R=x("inspection",()=>{const s=m([]),n=m({}),i=m({}),p=m(!1),v=l(()=>s.value.filter(e=>e.status==="待执行").length),f=l(()=>s.value.filter(e=>e.status==="进行中").length),X=l(()=>s.value.filter(e=>e.status==="已完成").length),N=l(()=>s.value.filter(e=>e.status==="已超时").length),d=()=>{p.value=!0;try{const e=localStorage.getItem("inspection_tasks");e?s.value=JSON.parse(e):(s.value=T,localStorage.setItem("inspection_tasks",JSON.stringify(T)))}catch(e){console.error("加载任务失败:",e),s.value=T}finally{p.value=!1}},u=()=>{try{localStorage.setItem("inspection_tasks",JSON.stringify(s.value))}catch(e){console.error("保存任务失败:",e),o.error("保存任务失败")}},h=e=>{s.value.unshift(e),u(),o.success("创建任务成功")},k=(e,t)=>{const r=s.value.findIndex(a=>a.taskNo===e);r!==-1&&(s.value[r]={...s.value[r],...t},u(),o.success("更新任务成功"))},S=e=>{const t=s.value.findIndex(r=>r.taskNo===e);t!==-1&&(s.value.splice(t,1),u(),o.success("删除任务成功"))},g=e=>{const t=s.value.find(r=>r.taskNo===e);return t?{...t,inspector:t.inspector}:null},A=e=>{try{const t=localStorage.getItem(`inspection_records_${e}`);t&&(n.value[e]=JSON.parse(t))}catch(t){console.error("加载记录失败:",t),o.error("加载记录失败")}},y=e=>{try{localStorage.setItem(`inspection_records_${e}`,JSON.stringify(n.value[e]||[]))}catch(t){console.error("保存记录失败:",t),o.error("保存记录失败")}},I=(e,t)=>{if(n.value[e]||(n.value[e]=[]),n.value[e].push(t),y(e),g(e)){const a=n.value[e].length*20,c=Math.min(Math.round(a),100);k(e,{progress:c})}},B=e=>{try{const t=localStorage.getItem(`inspection_abnormals_${e}`);t&&(i.value[e]=JSON.parse(t))}catch(t){console.error("加载异常记录失败:",t),o.error("加载异常记录失败")}},J=e=>{try{localStorage.setItem(`inspection_abnormals_${e}`,JSON.stringify(i.value[e]||[]))}catch(t){console.error("保存异常记录失败:",t),o.error("保存异常记录失败")}},_=(e,t)=>{i.value[e]||(i.value[e]=[]),i.value[e].push(t),J(e)},b=(e,t,r)=>{const a=i.value[e];if(a){const c=a.findIndex(C=>C.id===t);c!==-1&&(a[c]={...a[c],...r},J(e))}};return d(),{tasks:s,records:n,abnormals:i,loading:p,pendingTasks:v,processingTasks:f,completedTasks:X,timeoutTasks:N,loadTasks:d,addTask:h,updateTask:k,deleteTask:S,getTaskById:g,loadRecords:A,addRecord:I,loadAbnormals:B,addAbnormal:_,updateAbnormal:b}});export{R as u};
